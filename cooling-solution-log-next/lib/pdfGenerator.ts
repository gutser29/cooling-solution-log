import jsPDF from 'jspdf'
import autoTable from 'jspdf-autotable'
import type { EventRecord, Job, Invoice } from './types'

// ============ COMPANY INFO ============
const COMPANY_NAME = 'Cooling Solution'
const COMPANY_SLOGAN = 'Donde tu confort es nuestra prioridad'
const COMPANY_LOCATION = 'Puerto Rico'
const COMPANY_ADDRESS = 'PO BOX 168, Toa Alta, Puerto Rico 00954'
const COMPANY_PHONE = '939-425-6081'
const COMPANY_EMAIL = 'Sergio.gutierrez@coolingsolutionpr.com'

const LOGO_BASE64 = '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'

// ============ HELPERS ============

const KNOWN_LABELS: Record<string, string> = {
  cash: 'Efectivo',
  ath_movil: 'ATH Móvil',
  paypal: 'PayPal',
}

function getPaymentLabel(method: string | undefined | null): string {
  if (!method || method.trim() === '') return 'Sin registrar'
  const key = method.trim().toLowerCase()
  if (KNOWN_LABELS[key]) return KNOWN_LABELS[key]
  return key.split('_').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')
}

function normalizeText(text: string): string {
  return text.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '')
}

function formatCurrency(n: number): string {
  return `$${n.toFixed(2)}`
}

function formatDate(ts: number): string {
  return new Date(ts).toLocaleDateString('es-PR')
}

function addLogoHeader(doc: jsPDF): number {
  const pageW = doc.internal.pageSize.getWidth()
  
  // Logo on left
  try {
    doc.addImage('data:image/png;base64,' + LOGO_BASE64, 'PNG', 14, 10, 50, 21)
  } catch {
    doc.setFontSize(16)
    doc.setTextColor(0, 150, 150)
    doc.text(COMPANY_NAME, 14, 22)
  }
  
  // Company contact info on right
  doc.setFontSize(8)
  doc.setTextColor(80, 80, 80)
  doc.text(COMPANY_ADDRESS, pageW - 14, 12, { align: 'right' })
  doc.text(`Tel: ${COMPANY_PHONE}`, pageW - 14, 17, { align: 'right' })
  doc.text(COMPANY_EMAIL, pageW - 14, 22, { align: 'right' })
  
  return 35
}

function addSlogan(doc: jsPDF) {
  const pageH = doc.internal.pageSize.getHeight()
  const pageW = doc.internal.pageSize.getWidth()
  doc.setFontSize(8)
  doc.setTextColor(120, 120, 120)
  const sloganW = doc.getTextWidth(COMPANY_SLOGAN)
  doc.text(COMPANY_SLOGAN, (pageW - sloganW) / 2, pageH - 10)
}

function generateInvoiceNumber(type: 'invoice' | 'quote'): string {
  const prefix = type === 'invoice' ? 'CS-INV' : 'CS-COT'
  const d = new Date()
  const yr = d.getFullYear().toString().slice(-2)
  const mo = String(d.getMonth() + 1).padStart(2, '0')
  const rand = String(Math.floor(Math.random() * 9000) + 1000)
  return `${prefix}-${yr}${mo}-${rand}`
}

// ============ 1) CATEGORY REPORT ============

export function generateCategoryReport(
  events: EventRecord[],
  category: string,
  startDate: number,
  endDate: number
) {
  const searchTerm = normalizeText(category)
  const filtered = events.filter(e => {
    const inCat = (e.category && normalizeText(e.category).includes(searchTerm)) ||
                  (e.subtype && normalizeText(e.subtype).includes(searchTerm))
    const inDate = e.timestamp >= startDate && e.timestamp <= endDate
    return inCat && inDate
  })

  if (filtered.length === 0) {
    alert(`No se encontraron eventos de "${category}" en el período seleccionado`)
    return
  }

  const doc = new jsPDF()
  doc.setFontSize(18)
  doc.text(`Reporte: ${category}`, 14, 20)
  doc.setFontSize(10)
  doc.text(`${formatDate(startDate)} - ${formatDate(endDate)}`, 14, 28)
  doc.text(`Cooling Solution Log`, 14, 33)

  const paymentSummary: Record<string, number> = {}
  filtered.forEach(e => {
    const label = getPaymentLabel(e.payment_method)
    paymentSummary[label] = (paymentSummary[label] || 0) + e.amount
  })

  autoTable(doc, {
    startY: 40,
    head: [['Fecha', 'Monto', 'Método Pago', 'Detalle']],
    body: filtered.map(e => [
      formatDate(e.timestamp),
      formatCurrency(e.amount),
      getPaymentLabel(e.payment_method),
      e.vendor || e.note || e.category || '-'
    ]),
    foot: [['TOTAL', formatCurrency(filtered.reduce((s, e) => s + e.amount, 0)), '', '']]
  })

  const finalY = (doc as any).lastAutoTable.finalY + 10
  doc.setFontSize(12)
  doc.text('Desglose por método de pago:', 14, finalY)
  let y = finalY + 7
  Object.entries(paymentSummary).sort((a, b) => b[1] - a[1]).forEach(([method, total]) => {
    doc.setFontSize(10)
    doc.text(`${method}: ${formatCurrency(total)}`, 20, y)
    y += 6
  })

  doc.save(`${category}-${new Date().toISOString().split('T')[0]}.pdf`)
}

// ============ 2) P&L REPORT ============

export function generatePLReport(
  events: EventRecord[],
  jobs: Job[],
  startDate: number,
  endDate: number,
  periodLabel: string
) {
  const periodEvents = events.filter(e => e.timestamp >= startDate && e.timestamp <= endDate)
  const periodJobs = jobs.filter(j => j.date >= startDate && j.date <= endDate)

  const incomeEvents = periodEvents.filter(e => e.type === 'income')
  const totalIncome = incomeEvents.reduce((s, e) => s + e.amount, 0)

  let jobIncome = 0
  periodJobs.forEach(j => {
    j.payments.forEach(p => {
      if (p.date >= startDate && p.date <= endDate) jobIncome += p.amount
    })
  })
  const grossIncome = totalIncome + jobIncome

  const expenseEvents = periodEvents.filter(e => e.type === 'expense')
  const expenseByCategory: Record<string, number> = {}
  expenseEvents.forEach(e => {
    const cat = e.category || e.subtype || 'Otro'
    expenseByCategory[cat] = (expenseByCategory[cat] || 0) + e.amount
  })
  const totalExpenses = expenseEvents.reduce((s, e) => s + e.amount, 0)

  let totalPayroll = 0
  periodJobs.forEach(j => { j.employees.forEach(emp => { totalPayroll += emp.total_net }) })

  let materialCost = 0, materialCharged = 0
  periodJobs.forEach(j => {
    j.materials.forEach(m => {
      materialCost += m.unit_cost * m.quantity
      materialCharged += m.unit_price * m.quantity
    })
  })
  const materialProfit = materialCharged - materialCost

  const totalCosts = totalExpenses + totalPayroll
  const netProfit = grossIncome - totalCosts
  const profitMargin = grossIncome > 0 ? ((netProfit / grossIncome) * 100) : 0

  const expenseByMethod: Record<string, number> = {}
  expenseEvents.forEach(e => {
    const label = getPaymentLabel(e.payment_method)
    expenseByMethod[label] = (expenseByMethod[label] || 0) + e.amount
  })

  const doc = new jsPDF()

  doc.setFontSize(20)
  doc.setTextColor(40, 40, 40)
  doc.text('PROFIT & LOSS', 14, 20)
  doc.setFontSize(12)
  doc.text(`Cooling Solution Log`, 14, 27)
  doc.setFontSize(10)
  doc.setTextColor(100, 100, 100)
  doc.text(`Período: ${periodLabel}`, 14, 33)
  doc.text(`${formatDate(startDate)} - ${formatDate(endDate)}`, 14, 38)
  doc.text(`Generado: ${formatDate(Date.now())}`, 14, 43)

  doc.setFontSize(14)
  doc.setTextColor(40, 40, 40)
  doc.text('Resumen', 14, 55)

  const summaryColor = netProfit >= 0 ? [34, 139, 34] : [220, 20, 20]

  autoTable(doc, {
    startY: 60,
    head: [['Concepto', 'Monto']],
    body: [
      ['Ingresos Totales', formatCurrency(grossIncome)],
      ['  Cobros directos', formatCurrency(totalIncome)],
      ['  Pagos de trabajos', formatCurrency(jobIncome)],
      ['', ''],
      ['Gastos Totales', formatCurrency(totalCosts)],
      ['  Gastos operativos', formatCurrency(totalExpenses)],
      ['  Nómina empleados', formatCurrency(totalPayroll)],
      ['', ''],
      ['Ganancia en materiales', formatCurrency(materialProfit)],
      ['  (Costo: ' + formatCurrency(materialCost) + ' → Cobrado: ' + formatCurrency(materialCharged) + ')', ''],
    ],
    foot: [
      ['PROFIT NETO', formatCurrency(netProfit)],
      ['Margen', `${profitMargin.toFixed(1)}%`]
    ],
    styles: { fontSize: 10 },
    footStyles: { fillColor: summaryColor as any, textColor: [255, 255, 255] },
    columnStyles: { 1: { halign: 'right' } }
  })

  let currentY = (doc as any).lastAutoTable.finalY + 15

  doc.setFontSize(14)
  doc.text('Gastos por Categoría', 14, currentY)
  const catEntries = Object.entries(expenseByCategory).sort((a, b) => b[1] - a[1])
  autoTable(doc, {
    startY: currentY + 5,
    head: [['Categoría', 'Monto', '% del Total']],
    body: catEntries.map(([cat, amount]) => [cat, formatCurrency(amount), `${((amount / totalExpenses) * 100).toFixed(1)}%`]),
    foot: [['TOTAL', formatCurrency(totalExpenses), '100%']],
    styles: { fontSize: 9 },
    columnStyles: { 1: { halign: 'right' }, 2: { halign: 'right' } }
  })

  currentY = (doc as any).lastAutoTable.finalY + 15
  if (currentY > 240) { doc.addPage(); currentY = 20 }

  doc.setFontSize(14)
  doc.text('Gastos por Método de Pago', 14, currentY)
  const methodEntries = Object.entries(expenseByMethod).sort((a, b) => b[1] - a[1])
  autoTable(doc, {
    startY: currentY + 5,
    head: [['Método', 'Monto', '% del Total']],
    body: methodEntries.map(([method, amount]) => [method, formatCurrency(amount), `${((amount / totalExpenses) * 100).toFixed(1)}%`]),
    foot: [['TOTAL', formatCurrency(totalExpenses), '100%']],
    styles: { fontSize: 9 },
    columnStyles: { 1: { halign: 'right' }, 2: { halign: 'right' } }
  })

  doc.save(`PL-${periodLabel}-${new Date().toISOString().split('T')[0]}.pdf`)
}

// ============ 3) ACCOUNTS RECEIVABLE ============

export function generateARReport(jobs: Job[], clients: { id?: number; first_name: string; last_name: string }[]) {
  const pendingJobs = jobs.filter(j => j.payment_status === 'pending' || j.payment_status === 'partial')

  if (pendingJobs.length === 0) {
    alert('No hay cuentas pendientes de cobro')
    return
  }

  const clientMap = new Map(clients.map(c => [c.id, `${c.first_name} ${c.last_name}`]))

  const doc = new jsPDF()
  doc.setFontSize(20)
  doc.text('CUENTAS POR COBRAR', 14, 20)
  doc.setFontSize(10)
  doc.text(`Cooling Solution Log | ${formatDate(Date.now())}`, 14, 27)

  let totalPending = 0

  autoTable(doc, {
    startY: 35,
    head: [['Cliente', 'Trabajo', 'Fecha', 'Total', 'Pagado', 'Pendiente', 'Status']],
    body: pendingJobs.map(j => {
      const paid = j.payments.reduce((s, p) => s + p.amount, 0)
      const pending = j.total_charged - paid
      totalPending += pending
      return [
        clientMap.get(j.client_id) || `Cliente #${j.client_id}`,
        j.type, formatDate(j.date), formatCurrency(j.total_charged),
        formatCurrency(paid), formatCurrency(pending),
        j.payment_status === 'partial' ? 'Parcial' : 'Pendiente'
      ]
    }),
    foot: [['', '', '', '', 'TOTAL:', formatCurrency(totalPending), '']],
    styles: { fontSize: 9 },
    columnStyles: { 3: { halign: 'right' }, 4: { halign: 'right' }, 5: { halign: 'right' } }
  })

  const now = Date.now()
  const day = 86400000
  let u30 = 0, u60 = 0, u90 = 0, o90 = 0
  pendingJobs.forEach(j => {
    const pending = j.total_charged - j.payments.reduce((s, p) => s + p.amount, 0)
    const age = now - j.date
    if (age < 30 * day) u30 += pending
    else if (age < 60 * day) u60 += pending
    else if (age < 90 * day) u90 += pending
    else o90 += pending
  })

  const finalY = (doc as any).lastAutoTable.finalY + 15
  doc.setFontSize(14)
  doc.text('Aging (Antigüedad)', 14, finalY)
  autoTable(doc, {
    startY: finalY + 5,
    head: [['Período', 'Monto']],
    body: [['0-30 días', formatCurrency(u30)], ['31-60 días', formatCurrency(u60)], ['61-90 días', formatCurrency(u90)], ['90+ días', formatCurrency(o90)]],
    foot: [['TOTAL', formatCurrency(totalPending)]],
    styles: { fontSize: 10 },
    columnStyles: { 1: { halign: 'right' } }
  })

  doc.save(`Cuentas-por-Cobrar-${new Date().toISOString().split('T')[0]}.pdf`)
}

// ============ 4) PAYMENT METHOD REPORT ============

export function generatePaymentMethodReport(
  events: EventRecord[],
  paymentMethod: string,
  startDate: number,
  endDate: number
) {
  const searchPM = paymentMethod.toLowerCase().replace(/\s+/g, '_')
  const filtered = events.filter(e => {
    const pm = (e.payment_method || '').toLowerCase()
    return (pm === searchPM || pm.includes(searchPM)) && e.timestamp >= startDate && e.timestamp <= endDate
  })

  if (filtered.length === 0) {
    alert(`No se encontraron gastos con "${paymentMethod}" en el período`)
    return
  }

  const doc = new jsPDF()
  doc.setFontSize(18)
  doc.text(`Reporte: ${getPaymentLabel(paymentMethod)}`, 14, 20)
  doc.setFontSize(10)
  doc.text(`${formatDate(startDate)} - ${formatDate(endDate)}`, 14, 28)

  const catSummary: Record<string, number> = {}
  filtered.forEach(e => { catSummary[e.category || 'Otro'] = (catSummary[e.category || 'Otro'] || 0) + e.amount })

  autoTable(doc, {
    startY: 35,
    head: [['Fecha', 'Categoría', 'Monto', 'Detalle']],
    body: filtered.map(e => [formatDate(e.timestamp), e.category || e.subtype || '-', formatCurrency(e.amount), e.vendor || e.note || '-']),
    foot: [['TOTAL', '', formatCurrency(filtered.reduce((s, e) => s + e.amount, 0)), '']]
  })

  const finalY = (doc as any).lastAutoTable.finalY + 10
  doc.setFontSize(12)
  doc.text('Por categoría:', 14, finalY)
  let y = finalY + 7
  Object.entries(catSummary).sort((a, b) => b[1] - a[1]).forEach(([cat, total]) => {
    doc.setFontSize(10)
    doc.text(`${cat}: ${formatCurrency(total)}`, 20, y)
    y += 6
  })

  doc.save(`${paymentMethod}-${new Date().toISOString().split('T')[0]}.pdf`)
}

// ============ 5) INVOICE / QUOTE PDF ============

export function generateInvoicePDF(invoice: Invoice): Blob {
  const doc = new jsPDF()
  const pageW = doc.internal.pageSize.getWidth()
  const isQuote = invoice.type === 'quote'
  const title = isQuote ? 'COTIZACIÓN' : 'FACTURA'

  // === HEADER WITH LOGO ===
  const startY = addLogoHeader(doc)

  // Title + Number on right side
  doc.setFontSize(22)
  doc.setTextColor(40, 40, 40)
  doc.text(title, pageW - 14, 18, { align: 'right' })
  doc.setFontSize(11)
  doc.setTextColor(80, 80, 80)
  doc.text(`#${invoice.invoice_number}`, pageW - 14, 25, { align: 'right' })

  // Divider line
  doc.setDrawColor(0, 180, 180)
  doc.setLineWidth(0.8)
  doc.line(14, startY, pageW - 14, startY)

  let y = startY + 8

  // === DATES ===
  doc.setFontSize(9)
  doc.setTextColor(100, 100, 100)
  doc.text(`Fecha: ${formatDate(invoice.issue_date)}`, 14, y)
  if (invoice.due_date) {
    doc.text(`Vence: ${formatDate(invoice.due_date)}`, 80, y)
  }
  if (isQuote && invoice.expiration_date) {
    doc.text(`Válida hasta: ${formatDate(invoice.expiration_date)}`, 80, y)
  }
  if (invoice.status === 'paid' && invoice.paid_date) {
    doc.text(`Pagado: ${formatDate(invoice.paid_date)} (${getPaymentLabel(invoice.paid_method)})`, 140, y)
  }
  y += 10

  // === CLIENT INFO ===
  doc.setFontSize(10)
  doc.setTextColor(40, 40, 40)
  doc.text('CLIENTE:', 14, y)
  y += 6
  doc.setFontSize(12)
  doc.setTextColor(20, 20, 20)
  doc.text(invoice.client_name, 14, y)
  y += 5
  doc.setFontSize(9)
  doc.setTextColor(80, 80, 80)
  if (invoice.client_phone) { doc.text(`Tel: ${invoice.client_phone}`, 14, y); y += 4.5 }
  if (invoice.client_email) { doc.text(invoice.client_email, 14, y); y += 4.5 }
  if (invoice.client_address) { doc.text(invoice.client_address, 14, y); y += 4.5 }
  y += 6

  // === STATUS BADGE (for non-draft) ===
  if (invoice.status !== 'draft') {
    const statusLabels: Record<string, string> = {
      sent: 'ENVIADA', paid: 'PAGADA', overdue: 'VENCIDA', cancelled: 'CANCELADA'
    }
    const statusColors: Record<string, number[]> = {
      sent: [59, 130, 246], paid: [34, 197, 94], overdue: [239, 68, 68], cancelled: [156, 163, 175]
    }
    const label = statusLabels[invoice.status] || invoice.status.toUpperCase()
    const color = statusColors[invoice.status] || [100, 100, 100]
    const badgeW = doc.getTextWidth(label) + 10
    doc.setFillColor(color[0], color[1], color[2])
    doc.roundedRect(pageW - 14 - badgeW, y - 18, badgeW, 7, 2, 2, 'F')
    doc.setFontSize(8)
    doc.setTextColor(255, 255, 255)
    doc.text(label, pageW - 14 - badgeW / 2, y - 13.5, { align: 'center' })
    doc.setTextColor(40, 40, 40)
  }

  // === ITEMS TABLE ===
  autoTable(doc, {
    startY: y,
    head: [['#', 'Descripción', 'Cant.', 'Precio Unit.', 'Total']],
    body: invoice.items.map((item, i) => [
      String(i + 1),
      item.description,
      String(item.quantity),
      formatCurrency(item.unit_price),
      formatCurrency(item.total)
    ]),
    headStyles: {
      fillColor: [0, 150, 150],
      textColor: [255, 255, 255],
      fontStyle: 'bold',
      fontSize: 9
    },
    bodyStyles: { fontSize: 9 },
    columnStyles: {
      0: { cellWidth: 12, halign: 'center' },
      2: { cellWidth: 18, halign: 'center' },
      3: { cellWidth: 30, halign: 'right' },
      4: { cellWidth: 30, halign: 'right' }
    },
    styles: { cellPadding: 3 }
  })

  y = (doc as any).lastAutoTable.finalY + 5

  // === TOTALS SECTION (right-aligned) ===
  const totalsX = pageW - 80
  const valX = pageW - 14

  doc.setFontSize(10)
  doc.setTextColor(80, 80, 80)
  doc.text('Subtotal:', totalsX, y)
  doc.text(formatCurrency(invoice.subtotal), valX, y, { align: 'right' })
  y += 6

  if (invoice.tax_rate > 0) {
    doc.text(`IVU (${invoice.tax_rate}%):`, totalsX, y)
    doc.text(formatCurrency(invoice.tax_amount), valX, y, { align: 'right' })
    y += 6
  }

  // Total box
  doc.setFillColor(0, 150, 150)
  doc.roundedRect(totalsX - 5, y - 4, valX - totalsX + 19, 10, 2, 2, 'F')
  doc.setFontSize(12)
  doc.setTextColor(255, 255, 255)
  doc.text('TOTAL:', totalsX, y + 3)
  doc.text(formatCurrency(invoice.total), valX, y + 3, { align: 'right' })
  y += 16

  // === NOTES ===
  if (invoice.notes) {
    doc.setFontSize(9)
    doc.setTextColor(80, 80, 80)
    doc.text('Notas:', 14, y)
    y += 5
    doc.setTextColor(60, 60, 60)
    const lines = doc.splitTextToSize(invoice.notes, pageW - 28)
    doc.text(lines, 14, y)
    y += lines.length * 4.5
  }

  // === PAYMENT INFO (for invoices) ===
  if (!isQuote && invoice.status !== 'paid') {
    y += 5
    doc.setFontSize(9)
    doc.setTextColor(80, 80, 80)
    doc.text('Métodos de pago aceptados: Efectivo, ATH Móvil, Transferencia, PayPal', 14, y)
  }

  // === SLOGAN FOOTER ===
  addSlogan(doc)

  // Return as blob (for preview) instead of auto-download
  return doc.output('blob')
}

// Convenience: generate and download
export function downloadInvoicePDF(invoice: Invoice) {
  const doc = generateInvoicePDFDoc(invoice)
  const prefix = invoice.type === 'quote' ? 'Cotizacion' : 'Factura'
  doc.save(`${prefix}-${invoice.invoice_number}.pdf`)
}

// Full doc version (for download)
function generateInvoicePDFDoc(invoice: Invoice): jsPDF {
  const doc = new jsPDF()
  const pageW = doc.internal.pageSize.getWidth()
  const isQuote = invoice.type === 'quote'
  const title = isQuote ? 'COTIZACIÓN' : 'FACTURA'

  const startY = addLogoHeader(doc)

  doc.setFontSize(22)
  doc.setTextColor(40, 40, 40)
  doc.text(title, pageW - 14, 18, { align: 'right' })
  doc.setFontSize(11)
  doc.setTextColor(80, 80, 80)
  doc.text(`#${invoice.invoice_number}`, pageW - 14, 25, { align: 'right' })

  doc.setDrawColor(0, 180, 180)
  doc.setLineWidth(0.8)
  doc.line(14, startY, pageW - 14, startY)

  let y = startY + 8

  doc.setFontSize(9)
  doc.setTextColor(100, 100, 100)
  doc.text(`Fecha: ${formatDate(invoice.issue_date)}`, 14, y)
  if (invoice.due_date) doc.text(`Vence: ${formatDate(invoice.due_date)}`, 80, y)
  if (isQuote && invoice.expiration_date) doc.text(`Válida hasta: ${formatDate(invoice.expiration_date)}`, 80, y)
  if (invoice.status === 'paid' && invoice.paid_date) doc.text(`Pagado: ${formatDate(invoice.paid_date)} (${getPaymentLabel(invoice.paid_method)})`, 140, y)
  y += 10

  doc.setFontSize(10)
  doc.setTextColor(40, 40, 40)
  doc.text('CLIENTE:', 14, y)
  y += 6
  doc.setFontSize(12)
  doc.setTextColor(20, 20, 20)
  doc.text(invoice.client_name, 14, y)
  y += 5
  doc.setFontSize(9)
  doc.setTextColor(80, 80, 80)
  if (invoice.client_phone) { doc.text(`Tel: ${invoice.client_phone}`, 14, y); y += 4.5 }
  if (invoice.client_email) { doc.text(invoice.client_email, 14, y); y += 4.5 }
  if (invoice.client_address) { doc.text(invoice.client_address, 14, y); y += 4.5 }
  y += 6

  if (invoice.status !== 'draft') {
    const statusLabels: Record<string, string> = { sent: 'ENVIADA', paid: 'PAGADA', overdue: 'VENCIDA', cancelled: 'CANCELADA' }
    const statusColors: Record<string, number[]> = { sent: [59, 130, 246], paid: [34, 197, 94], overdue: [239, 68, 68], cancelled: [156, 163, 175] }
    const label = statusLabels[invoice.status] || invoice.status.toUpperCase()
    const color = statusColors[invoice.status] || [100, 100, 100]
    const badgeW = doc.getTextWidth(label) + 10
    doc.setFillColor(color[0], color[1], color[2])
    doc.roundedRect(pageW - 14 - badgeW, y - 18, badgeW, 7, 2, 2, 'F')
    doc.setFontSize(8)
    doc.setTextColor(255, 255, 255)
    doc.text(label, pageW - 14 - badgeW / 2, y - 13.5, { align: 'center' })
    doc.setTextColor(40, 40, 40)
  }

  autoTable(doc, {
    startY: y,
    head: [['#', 'Descripción', 'Cant.', 'Precio Unit.', 'Total']],
    body: invoice.items.map((item, i) => [String(i + 1), item.description, String(item.quantity), formatCurrency(item.unit_price), formatCurrency(item.total)]),
    headStyles: { fillColor: [0, 150, 150], textColor: [255, 255, 255], fontStyle: 'bold', fontSize: 9 },
    bodyStyles: { fontSize: 9 },
    columnStyles: { 0: { cellWidth: 12, halign: 'center' }, 2: { cellWidth: 18, halign: 'center' }, 3: { cellWidth: 30, halign: 'right' }, 4: { cellWidth: 30, halign: 'right' } },
    styles: { cellPadding: 3 }
  })

  y = (doc as any).lastAutoTable.finalY + 5
  const totalsX = pageW - 80
  const valX = pageW - 14

  doc.setFontSize(10)
  doc.setTextColor(80, 80, 80)
  doc.text('Subtotal:', totalsX, y)
  doc.text(formatCurrency(invoice.subtotal), valX, y, { align: 'right' })
  y += 6

  if (invoice.tax_rate > 0) {
    doc.text(`IVU (${invoice.tax_rate}%):`, totalsX, y)
    doc.text(formatCurrency(invoice.tax_amount), valX, y, { align: 'right' })
    y += 6
  }

  doc.setFillColor(0, 150, 150)
  doc.roundedRect(totalsX - 5, y - 4, valX - totalsX + 19, 10, 2, 2, 'F')
  doc.setFontSize(12)
  doc.setTextColor(255, 255, 255)
  doc.text('TOTAL:', totalsX, y + 3)
  doc.text(formatCurrency(invoice.total), valX, y + 3, { align: 'right' })
  y += 16

  if (invoice.notes) {
    doc.setFontSize(9)
    doc.setTextColor(80, 80, 80)
    doc.text('Notas:', 14, y)
    y += 5
    doc.setTextColor(60, 60, 60)
    const lines = doc.splitTextToSize(invoice.notes, pageW - 28)
    doc.text(lines, 14, y)
  }

  if (!isQuote && invoice.status !== 'paid') {
    y += 8
    doc.setFontSize(9)
    doc.setTextColor(80, 80, 80)
    doc.text('Métodos de pago aceptados: Efectivo, ATH Móvil, Transferencia, PayPal', 14, y)
  }

  addSlogan(doc)
  return doc
}

export { generateInvoiceNumber }